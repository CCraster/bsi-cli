#!/usr/bin/env node

const program = require('commander');
const chalk = require('chalk');
const inquirer = require('inquirer');
program.option('-o, --output <file>', 'Output file path (default STDOUT)')
  .parse(process.argv);
const time = program.args[0];

function format (number) {
  number.length === 10 && ( number = number * 1000 );
  const date = new Date(number);
  return `${ date.getFullYear() }-${ date.getMonth() +
  1 }-${ date.getDate() } ${ date.getHours() }:${ date.getMinutes() }:${ date.getSeconds() }`;
}

if (time) {
  validateInput(time);
} else {
  async function getAnswer () {
    return await inquirer.prompt([
      {
        type: 'input',
        name: 'timeStr',
        message: chalk.red('What time do you want?'),
        prefix: 'ðŸ¦„',
      },
    ]);
  }
  
  getAnswer().then(({timeStr}) => {
    validateInput(timeStr);
  });
  
}

function validateInput (input) {
  const isTimeStamps = /^\d+$/.test(input);
  if (isTimeStamps) {
    console.log(`è¾“å…¥çš„æ—¶é—´æˆ³å¯¹åº”çš„æ—¶é—´ä¸º    ${ chalk.cyan(format(input)) }`);
  } else {
    console.log(`è¾“å…¥çš„æ—¶é—´å¯¹åº”çš„æ—¶é—´æˆ³ä¸º   ${ chalk.cyan(new Date(input).valueOf()) }`);
  }
  process.exit(-1);
}